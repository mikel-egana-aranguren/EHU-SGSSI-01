<!DOCTYPE html>
<html lang="en">
<head>
    <title>Seguridad en Sistemas Web</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../ShowerTemplate/shower/themes/ribbon/styles/styles.css">
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
        }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>
<body class="shower list">
    <header class="caption">
        <h1>Seguridad en Sistemas Web</h1>
        <p>Mikel Egaña Aranguren</p>
    </header>

    <section class="slide" id="cover">
        <h2>Seguridad en Sistemas Web</h2>
        <p>Mikel Egaña Aranguren</p>
        <p><a href="https://mikel-egana-aranguren.github.io/">mikel-egana-aranguren.github.io</a></p>
        <p><a href="mailto:mikel.egana@ehu.eus">mikel.egana@ehu.eus</a></p>
        <img src="../ShowerTemplate/pictures/ehu.png" alt="UPV/EHU ingenieros San Mames" height="25%" border="1px solid #555">
    </section>

    <section class="slide">
        <h2>Seguridad en Sistemas Web</h2>
        <p><a href="https://doi.org/10.5281/zenodo.4302267">https://doi.org/10.5281/zenodo.4302267</a></p>
        <p><a href="https://github.com/mikel-egana-aranguren/EHU-SGSSI-01">https://github.com/mikel-egana-aranguren/EHU-SGSSI-01</a></p>
        <img src="../ShowerTemplate/pictures/by.png" alt="Creative Commons BY" height="10%">
    </section>

    <section class="slide">
        <h2>Seguridad en Sistemas Web</h2>
        <ul>
            <li>Fuentes de información en seguridad</li>
            <li>Rotura de control de acceso</li>
            <li>Fallos criptográficos</li>
            <li>Inyección</li>
            <li>Diseño inseguro</li>
            <li>Configuración de seguridad insuficiente</li>
            <li>Componentes vulnerables y obsoletos</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Seguridad en Sistemas Web</h2>
        <ul>
            <li>Fuentes de información en seguridad</li>
            <li>Rotura de control de acceso</li>
            <li>Fallos criptográficos</li>
            <li>Inyección</li>
            <li>Diseño inseguro</li>
            <li>Configuración de seguridad insuficiente</li>
            <li>Componentes vulnerables y obsoletos</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Seguridad en Sistemas Web</h2>
        <ul>
            <li>Fallos de identificación y autenticación</li>
            <li>Fallos en la integridad de datos y software</li>
            <li>Fallos en la monitorización de la seguridad</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fuentes de información en seguridad</h2>
        <p><a href="https://cwe.mitre.org/">CWE</a> (Common Weakness Enumeration), <a href="https://www.mitre.org/">MITRE</a>: lista de debilidades de software y hardware que pueden llevar a debilidades específicas (Ej. <a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a>).</p>
        <p><a href="https://www.cve.org/">CVE</a> (Common Vulnerabilities and Exposures), <a href="https://www.mitre.org/">MITRE</a>: lista de vulnerabilidades specíficas (Ej. <a href="https://www.cve.org/CVERecord?id=CVE-2021-44228">CVE-2021-44228</a>).</p>
    </section>

    <section class="slide">
        <h2>Fuentes de información en seguridad</h2>
        <p>OWASP Top Ten (<a href="https://owasp.org/Top10/">2021</a>), <a href="https://owasp.org/">Open Web Application Security Project</a>: expone en un ranking las vulnerabilidades Web más comúnes, enlazando con CWEs y CVEs.</p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso</h2>
         <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Broken access control (A01:2021)</a>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso</h2>
        <p>El control de acceso obliga al usuario a actuar solo dentro de los límites establecidos por los permisos definidos</p>
        <p>Fallar en el control de acceso resulta en consecuencias graves</p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: vulnerabilidades</h2>
        <p>Violación del principio de "denegación por defecto": el acceso solo debería ser garantizado a ciertas capacidades, roles, o usuarios, pero está al alcance de cualquiera</p>
        <p><img  style="border: 1px solid #555;"  src="pictures-sgssi-01/GAUR-guias-docentes-rotura-control-acceso.png" alt="En el mantenimiento de las guias docentes de GAUR el primer profesor que acceda a la guia, aunque no tenga permisos, se queda con la guia y la puede modificar si quiere" title="En el mantenimiento de las guias docentes de GAUR el primer profesor que acceda a la guia, aunque no tenga permisos, se queda con la guia y la puede modificar si quiere" width="70%"></p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: vulnerabilidades</h2>
        <p>Burlar el control de acceso mediante parámetros URL o las peticiones APIs</p>
        <p>Acceder a una cuenta personal e incluso modificar los datos con el identificador del usuario</p>
        <p>Acceso API sin control para los métodos HTTP POST, PUT, y DELETE</p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: vulnerabilidades</h2>
        <p><b>Elevación de privilegio:</b> actuar como administrador estando logeado como usuario</p>
        <p>Replaying o modificación de JSON Web Token (JWT) para elevar privilegios</p>
        <p>Mala configuración de CORS permite acceso API desde origenes no autorizados</p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: vulnerabilidades</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Exposure of Sensitive Information to an Unauthorized Actor</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/201.html">CWE-201: Insertion of Sensitive Information Into Sent Data</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: prevención</h2>
        <p>Denegación por defecto para todos los recursos, excepto públicos</p>
        <p>Implementar mecanismos de acceso de control una sola vez y extenderlos a toda la aplicación, minimizando el uso de CORS</p>
        <p>No permitir listado de directorios y asegurarse de que no hay archivos de metadatos (ej. Git) ni de backups en el nivel root de la aplicación</p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: prevención</h2>
        <p>Logear todos los intentos de entrada, alertar a los administradores cuando sea necesario (ej. muchos accesos fallidos)</p>
        <p>Limitar la tasa de peticiones de API para evitar ataques mediante programas</p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: prevención</h2>
        <p>Identificadores de sesión:
            <ul>
                <li>De servidor (stateful): invalidar al deslogearse</li>
                <li>Stateless JWT tokens: muy poca vida</li>
                <li>Para JWT de tiempo más largo, seguir el protocolo <a href="https://oauth.net/">OAuth</a> de cara a revocar el acceso</li>
            </ul>
        </p>
    </section>

    <section class="slide">
        <h2>Rotura de control de acceso: ejemplo</h2>
        <p>Llamada a SQL para obtener información de cuenta, con datos sin verificar:</p>
        <pre>
            <code>pstmt.setString(1, request.getParameter("acct"));</code>
            <code>ResultSet results = pstmt.executeQuery( );</code>
        </pre>
        <p>El atacante solo tiene que usar la URL <b>https://example.com/app/accountInfo?acct=notmyacct</b></p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos</h2>
        <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Cryptographic Failures (A02:2021)</a>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos</h2>
        <p>Fallos en los métodos criptográficos usados que resultan en exposición de datos</p>
        <p>Determinar las necesidades de protección de los datos tanto en transmisión como en almacenamiento (At rest): leyes de protecciones de datos</p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos</h2>
        <p>¿Los datos se transmiten como texto plano? Tanto en conexiones externas como internas (ej. servidores de balance de carga): HTTP, SMTP, FTP ...</p>
        <p>¿Se usan algoritmos o protocolos obsoletos o débiles?</p>
        <p>¿Se usan claves débiles o claves por defecto?</p>
        <p>¿Se aplica una gestión de claves adecuada?</p>
    </section>

    <section class="slide">
        <h2>Gestión de claves</h2>
        Ciclo de vida de una clave:
        <ol>
            <li>Generación</li>
            <li>Distribución</li>
            <li>Uso</li>
            <li>Almacenamiento</li>
            <li>Rotación, revocación, destrucción</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Gestión de claves: generación</h2>
        <p>Evitar algoritmos débiles</p>
        <p>Usar Key Generators o Random Number Generators de alta entropía </p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: distribución</h2>
        <p>Usar conexiones seguras como SSL/TLS para evitar ataques Man in the middle</p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: uso</h2>
        <p>Asegurar que solo las personas autorizadas usan la clave</p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: almacenamiento</h2>
        <p>Idealmente usar hardware dedicado: <a href="https://en.wikipedia.org/wiki/Hardware_security_module">Hardware Security Module</a>:
            <ul>
                <li>Dejan de funcionar cuando hay un acceso físico</li>
                <li>Cumplen estándares rigurosos como <a href="https://csrc.nist.gov/publications/detail/fips/140/3/final">FIPS 140-2</a> (Nivel 4)</li>
            </ul>
        </p>
        <p>También se pueden usar servicios en la nube: <a href="https://cloud.google.com/security-key-management">Google Cloud Key Management</a></p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: rotación</h2>
        <p>Cuando una clave agota su periodo de validez, se retira, descifrando y volviendo a cifrar los datos con una clave nueva</p>
        <p>Cuanto más tiempo esté una clave en circulación, más probable que sea comprometida</p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: revocación o destrucción</h2>
        <p>Si una clave ha sido comprometida, hay que revocarla, aunque este dentro de su periodo de validez</p>
        <p>Hay estándares que exigen guardar la clave revocada, por si hiciera falta en el futuro para descifrar datos (ej. en un juicio)</p>
        <p>La destrucción completa de la clave implica no poder usarla en el futuro</p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: buenas prácticas</h2>
        <p>No escribir valores de la clave en el código de software, aunque sea seguro</p>
        <p>Principio del menor privilegio: un usuario debería tener acceso sólo a las claves que realmente necesita</p>
        <p>Usar HSMs</p>
    </section>

    <section class="slide">
        <h2>Gestión de claves: buenas prácticas</h2>
        <p>Automatizar la gestión de claves lo más posible</p>
        <p>Dividir la generación, distribución etc. entre diferentes personas</p>
        <p>Dividir las claves en fragmentos</p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos</h2>
        <p>¿El certificado del servidor es válido y de confianza, garantizado por un AC?</p>
        <p>¿Se usan las contraseñas de los usuarios directamente como claves, en vez de usar password-based key derivation functions (PBKDFs)?</p>
        <p>¿Es la semilla de aleatoriedad usada lo suficientemente fuerte?</p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos: prevención</h2>
        <p>Clasificar los datos transmitidos, procesados y almacenados según su nivel de exigencia de privacidad</p>
        <p>Almacenar la menor cantidad de datos sensibles posible, incluso usando métodos como <a href="https://www.securitymetrics.com/blog/what-tokenization-and-how-can-i-use-it-pci-dss-compliance">Tokenización</a></p>
        <p>Cifrar todos los datos almacenados (Encription at rest)</p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos: prevención</h2>
        <p>Usar algoritmos actualizados (No usar MD5, SHA1, ...), claves fuertes, y gestión de claves</p>
        <p>Cifrar todos los datos en tránsito con protocolos como TLS FS (TLS + Forward Secrecy)</p>
        <p>No permitir el uso de cachés en el cliente para datos sensibles</p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos: prevención</h2>
        <p>Almacenar contraseñas con hashes + sal</p>
        <p>Usar semillas con la mayor entropía posible</p>
    </section>

    <section class="slide">
        <h2>Fallos criptográficos: ejemplos</h2>
        <p>Una aplicación usa la función por defecto de la base de datos para encriptar datos. Sin embargo estos datos se desencriptan automáticamente al consultarlos, permitiendo el acceso si por ejemplo hay un ataque de Inyección SQL</p> 
    </section>

    <section class="slide">
        <h2>Fallos criptográficos: ejemplos</h2>
        <p>Una web no obliga al uso de TLS. Si un atacante monitoriza el tráfico y "baja" una conexión de HTTPS a HTTP puede interceptar consultas y conseguir la cookie de sesión del usuario. El atacante reenvia la cookie (replay) secuestrando la sesión del usuario y obteniendo acceso a los datos de usuario</p>
        <p>La base de datos usa hashes sin sal. Un atacante puede pre-calcular los hashes con <a href="https://en.wikipedia.org/wiki/Graphics_processing_unit">GPUs</a></p>  
    </section>

    <section class="slide">
        <h2>Fallos criptográficos: vulnerabilidades</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/259.html">CWE-259: Use of Hard-coded Password</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/327.html">CWE-327: Broken or Risky Crypto Algorithm</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/331.html">CWE-331: Insufficient Entropy</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Inyección</h2>
         <a href="https://owasp.org/Top10/A03_2021-Injection/">Injection (A03:2021)</a>
    </section>

    <section class="slide">
        <h2>Inyección</h2>
        Una aplicación es vulnerable si:
        <ul>
            <li>Los datos que provee el usuario no se validan, filtran, o limpian</li>
            <li>El intérprete usa directamente consultas dinámicas o llamadas no parametrizadas sin "escaping"</li>
            <li>Datos hostiles introducidos por el usuario son usados directamente. La sentencia SQL o comando que se use contiene estructuras/datos maliciosos en consultas dinámicas, comandos, o procedimientos almacenados</li>
        </ul>

    </section>

    <section class="slide">
        <h2>Inyección SQL</h2>
        <p><img  style="border: 1px solid #555;"  src="pictures-sgssi-01/boy.png" alt="Bobby tables" width="90%"></p>
        <p style="text-align:left;font-size:30%;"><a href="https://xkcd.com/327/">https://xkcd.com/327/</a></p>
    </section>

    <section class="slide">
        <h2>(Inyección en LLMs)</h2>
        <a href="https://simonwillison.net/2023/Oct/14/multi-modal-prompt-injection/">Multi-modal prompt injection image attacks against GPT-4V</a>
    </section>

    <section class="slide">
        <h2>Inyección SQL</h2>
        <pre><code>
txtUserId = getRequestString("UserId");
txtSQL = "SELECT * FROM Users 
WHERE UserId = " + txtUserId;
        </code></pre> 
    </section>

    <section class="slide">
        <h2>Inyección SQL</h2>
        Input web: <code>105 OR 1=1</code>
        <pre><code>SELECT * FROM Users WHERE UserId = 105 OR 1=1;
        </code></pre>
        OR 1=1 es siempre true, va a devolver todas las lineas de la columna Users 
    </section>

    <section class="slide">
        <h2>Consultas parametrizadas</h2>
        <p>Parámetros: valores que se añaden a la consulta al ejecutarla y son analizadas de forma literal (ej. si la variable hace referencia a nombres de columnas, el intérprete se asegura de que los parámetros son nombres de columnas antes de añadirlas a la consulta y ejecutarla) </p>   
    </section>

    <section class="slide">
        <h2>Consultas parametrizadas</h2>
        <pre><code>
$stmt = $dbh->prepare("INSERT INTO Customers 
(CustomerName,Address,City) 
VALUES (:nam, :add, :cit)");
$stmt->bindParam(':nam', $txtNam);
$stmt->bindParam(':add', $txtAdd);
$stmt->bindParam(':cit', $txtCit);
$stmt->execute();
        </code></pre>    
    </section>

    <section class="slide">
        <h2>Object-Relational Mapping (ORM)</h2>
        <p>Frameworks que traducen el contenido de la base de datos a objetos</p>
        <p>No hay una conexión directa con la base de datos</p>
    </section>

    <section class="slide">
        <h2>Object-Relational Mapping (ORM)</h2>
        <pre><code>
String sql = "SELECT ... FROM persons WHERE id = 10"
DbCommand cmd = new DbCommand(connection, sql);
Result res = cmd.Execute();
String name = res[0]["FIRST_NAME"];
Person p = repository.GetPerson(10);
String name = p.FirstName;
        </code></pre>
    </section>

    <section class="slide">
        <h2>Inyección: detección de vulnerabilidad</h2>
        <p>Revisión del código fuente</p>
        <p>Testeo automatizado de inputs en forma de parámetros, cabeceras HTTP, URLs, cookies, JSON, y XML</p>
        <p>Application Security Testing en pipelines de <a href="https://github.com/mikel-egana-aranguren/Transparent-Relations-Ontology/blob/main/.github/workflows/robot.yml">Integración Continua</a>/Despliegue Continuo</p>
        
    </section>

    <section class="slide">
        <h2>Inyección: prevención</h2>
        <p>Usar APIs seguras que no usen el intérprete. Si no es posible, usar llamadas parametrizadas u ORM</p>
        <p>Validar los inputs</p>
        <p>"Escapar" todos los caracteres especiales posibles</p>
        <p>Usar controles como LIMIT en SQL para evitar pérdida masiva de datos</p>        
    </section>

    <section class="slide">
        <h2>Inyección</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/73.html">CWE-73: External Control of File Name or Path</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Diseño inseguro</h2>
         <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Insecure Design (A04:2021)</a>
    </section>

    <section class="slide">
        <h2>Diseño inseguro</h2>
        <p>Fallos de arquitectura, antes de implementar código</p>
    </section>

    <!-- <section class="slide">
        <h2>Software Assurance Maturity Model</h2>
        <p><a href="https://owaspsamm.org/">https://owaspsamm.org/</a></p>
        <p><a href="SAMM-v2-PDF.pdf">SAMM-v2-PDF.pdf</a></p>
    </section> -->

    <section class="slide">
        <h2>Diseño inseguro: ejemplos</h2>
        <p>Una cadena de e-commerce sin protección antibots puede recibir muchas peticiones de compradores a través de bots para vender los productos en otros sitios. Esto se puede evitar, por ejemplo, añadiendo en la arquitectura componentes que detecten bots (Muchas peticiones en poco tiempo, petición al de pocos segundos de publicar un producto, etc.)</p>
    </section>

    <section class="slide">
        <h2>Diseño inseguro</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/209.html">CWE-209 Generation of Error Message Containing Sensitive Information</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/256.html">CWE-256 Unprotected Storage of Credentials</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/501.html">CWE-501 Trust Boundary Violation</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/522.html">CWE-522 Insufficiently Protected Credentials</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Configuración de seguridad insuficiente</h2>
         <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Security Misconfiguration (A05:2021)</a>
    </section>

    <section class="slide">
        <h2>Configuración de seguridad insuficiente</h2>
        La aplicación podría ser vulnerable si:
        <ul>
            <li>Tiene permisos inadecuados en un servicio en la nube</li>
            <li>Hay funciones activas innecesarias (Puertos, servicios, páginas, cuentas, privilegios/permisos)</li>
            <li>Las cuentas por defecto y sus contraseñas siguen activas</li>
            <li>La gestión de los errores desvela información (ej. stack traces en excepciones Java) / los errores son demasiado informativos</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Configuración de seguridad insuficiente</h2>
        La aplicación podría ser vulnerable si:
        <ul>
            <li>Para sistemas actualizados, los últimos parches de seguridad no están activos y/o configurados adecuadamente</li>
            <li>Las opciones de seguridad en frameworks (Struts, Spring, ASP.net, ...), librerías, bases de datos etc. no están activadas</li>
            <li>El servidor no responde con <a href="https://web.dev/security-headers/">cabeceras HTTP de seguridad</a></li>
        </ul>
    </section>

    <section class="slide">
        <h2>Configuración de seguridad insuficiente: prevención</h2>
        <ul>
            <li>Sistema de desarrollo automatizado en el que es sencillo desplegar un entorno más seguro. Los entornos de desarrollo, pruebas, y producción deberían tener exactamente la misma configuración, a diferencia solo de credenciales. Este proceso debería estar lo mas automatizado posible para facilitar la creación de un nuevo entorno seguro lo más rápido posible</li>
            <li>Un sistema minimalista sin componentes o funciones innecesarias</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Configuración de seguridad insuficiente</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16 Configuration</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611 Improper Restriction of XML External Entity Reference</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Componentes vulnerables y obsoletos</h2>
         <a href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/">Vulnerable and Outdated Components (A06:2021)</a>
    </section>

    <section class="slide">
        <h2>Componentes vulnerables y obsoletos</h2>
        La aplicación podría ser vulnerable si:
        <ul>
            <li>No se saben exactamente todas las versiones de los componentes (Siempre se usa "latest"). Esto incluye componentes que se usan directamente y las dependencias indirectas</li>
            <li>Si el software no tiene soporte, es vulnerable, u obsoleto. Esto incluye al sistema operativo, servidor web, sistema de gestión de bases de datos, APIs y sus componentes, entornos de ejecución, y librerías</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Componentes vulnerables y obsoletos</h2>
        La aplicación podría ser vulnerable si:
        <ul>
            <li>Si no se escanea el sistema regularmente para buscar vulnerabilidades, y el administrador no está suscrito a boletines de seguridad sobre los componentes en uso</li>
            <li>Si no se actualizan los componentes con una frecuencia basada en el riesgo. Esto es muy común en grandes organizaciones que tienen políticas de aplicaciones de parches una vez al mes, dejando al sistema vulnerable durante días</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Componentes vulnerables y obsoletos: prevención</h2>
        Debería haber un proceso de aplicacion de parches para:
        <ul>
            <li>Quitar dependencias que no se usan, funcionalidades, componentes, archivos innecesarios, etc.</li>
            <li>Tener un inventario actualizado de componentes en servidor y cliente, incluyendo sus dependencias, de manera automatizada. Visitar regularmente recursos como CVE para encontrar vulnerabilidades en esos componentes</li>
            <li>Obtener componentes solo de fuentes oficiales y firmados</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación</h2>
         <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Identification and Authentication Failures (A07:2021)</a>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación</h2>
        <p>La confirmación de identidad de usuarios, autenticación, y la gestión de sesiones son funciones críticas para proteger al sistema contra ataques basado en autenticación</p>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación</h2>
        Puede haber vulnerabilidaes relacionadas con la autenticación si:
        <ul>
            <li>Permite ataque automatizados como el <a href="https://www.cloudflare.com/learning/bots/what-is-credential-stuffing/">Credential Stuffing</a> en los que un atacante tiene una lista de usuarios y contraseñas válidos</li>
            <li>Permite ataques de fuerza bruta</li>
            <li>Permite contraseñas por defecto, débiles o muy conocidas (ej. admin test)</li>
            <li>Usa mecanismos débiles para la recuperación de contraseñas, como el responder ciertas preguntas</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación</h2>
        Puede haber vulnerabilidaes relacionadas con la autenticación si:
        <ul>
            <li>Almacena las contraseñas en texto plano, o con hashes débiles</li>
            <li>No usa autenticacion multi-factor</li>
            <li>Expone identificadores de sesión en la URL</li>
            <li>No invalida sesiones después de logout o inactividad</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación: prevención</h2>

        <ul>
            <li>Si es posible implementar autenticación multi-factor</li>
            <li>No hacer despliegues con credenciales por defecto, especialmente para usuarios admin</li>
            <li>Implementar validaciones "ligeras" de contraseñas, como buscar las contraseñas en la lista de las 10.000 peores contraseñas</li>
            <li>Tener una buena política de tamaño de contraseñas, complejidad y rotación de contraseñas</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación: prevención</h2>

        <ul>
            <li>Limitar o retrasar los intentos fallidos de login, pero sin crear una situación de denegación de servicio. Logear todos los intentos fallidos y alertar a los administradores si hay ataques de credential stuffing</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación: prevención</h2>

        <ul>
            <li>Usar un gestor de sesiones en el lado de servidor que sea seguro y esté implementado junto con la aplicación. Debe generar un identificador de sesión aleatorio de gran entropía después del login. Los identificadores de sesión no deberían estar en la URL, sino almacenados de manera segura. Los identificadores deberían ser invalidados inmediatamente después del logout o inactividad</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos de identificación y autenticación</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/297.html">CWE-297: Improper Validation of Certificate with Host Mismatch</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287: Improper Authentication</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software</h2>
         <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">Software and Data Integrity Failures (A08:2021)</a>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software</h2>
        <p>Se dan cuando hay código e infraestructura que no protege contra violaciones de su integridad</p>
        <p>Por ejemplo si una aplicación depende de librerías, plugins o módulos que han sido obtenidos de fuentes sin confianza, repositorios, o <a href="https://en.wikipedia.org/wiki/Content_delivery_network">CDNs (Content Delivery Networks)</a></p>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software</h2>
        <p>Un pipeline de integración continua o despliegue continuo (IC/DC) puede introducir código malicioso</p>
        <p>Muchas aplicaciones incluyen funciones de auto-actualización sin los debidos tests de integridad</p>
        <p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html">Des-serialización insegura</a></p>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software: prevención</h2>
        <p>Usar firmas digitales o mecanismos similares para verificar que el software es de la fuente oficial y no ha sido alterado</p>
        <p>Asegurarse de que las gestores de librerías como <a href="https://www.npmjs.com/">NPM</a> o <a href="https://maven.apache.org/">Apache Maven</a> usan fuentes de fiar. Valorar alojar repositorios propios con mayor seguridad (ej. <a href="https://www.sonatype.com/products/nexus-repository">Nexus</a>)</p>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software: prevención</h2>
        <p>Asegurarse de que los pipelines IC/DC tienen una configuración y control de acceso adecuados para asegurar la integridad del código en todo el proceso</p>
        <p>Asegurarse de que no se envían datos serializados sin firmar o cifrar a clientes sin confianza sin algún tipo de validación de integridad para detectar modificación o un replay de los datos des-serializados</p>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software: ejemplos de escenarios de ataque</h2>
        <p>Muchos routers para el hogar aplican actualizaciones de firmware sin verificar. Se espera que los ataques a estos  aumenten en los proximos años</p>
        <p><a href="https://www.cvedetails.com/cve/CVE-2020-10148/">Solar Winds Orion attack</a> (Alcanzó a unas 18.000 organizaciones en todo el mundo)</p>
        <p></p>
    </section>

    <section class="slide">
        <h2>Fallos en la integridad de datos y software</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/829.html">
                CWE-829: Inclusion of Functionality from Untrusted Control Sphere</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/494.html">CWE-494: Download of Code Without Integrity Check</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502: Deserialization of Untrusted Data</a></li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos en la monitorización de la seguridad</h2>
         <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">Security Logging and Monitoring Failures (A09:2021)</a>
    </section>
    
    <section class="slide">
        <h2>Fallos en la monitorización de la seguridad</h2>
        No hay una monitorización adecuada si:
        <ul>
            <li>Los eventos auditables tales como logins, logins fallidos, o transacciones de alto valor no son almacenados en un log (registro)</li>
            <li>Los errores y advertencias generan mensajes inadecuados en los logs (O no los generan)</li>
            <li>Los logs de las APIs y las aplicaciones no se monitorizan para detectar comportamiento sospechoso</li>
            <li>Los logs solo se almacenan en local</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos en la monitorización de la seguridad</h2>
        No hay una monitorización adecuada si:
        <ul>
            <li>No hay procesos de respuesta automáticos a partir de ciertos umbrales</li>
            <li>El pen-testing con herramientas como OWASP ZAP no genera alertas</li>
            <li>La aplicación no es capaz de detectar o alertar sobre ataques en marcha en tiempo real</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos en la monitorización de la seguridad: prevención</h2>
        <ul>
            <li>Asegurarse de que todos los fallos de login, control de acceso, o validación de inputs son registrados en el log con suficiente contexto de usuario para poder identificar cuentas sospechosas y almacenados con suficiente tiempo para hacer un análisis forense</li>
            <li>Asegurarse de que los logs son generados de tal manera que las soluciones automatizadas pueden consumirlos fácilmente</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos en la monitorización de la seguridad: prevención</h2>
        <ul>
            <li>Asegurarse de que las transacciones de gran valor tienen un adecuado registro de procedencia con controles de integridad para prevenir modificaciones </li>
            <li>Establecer e implementar un plan de respuesta y recuperación, probándolo periódicamente</li>
        </ul>
    </section>

    <section class="slide">
        <h2>Fallos en la monitorización de la seguridad</h2>
        <ul>
            <li><a href="https://cwe.mitre.org/data/definitions/117.html">CWE-117: Improper Output Neutralization for Logs</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/223.html">CWE-223: Omission of Security-relevant Information</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/532.html">CWE-532: Insertion of Sensitive Information into Log File</a></li>
            <li><a href="https://cwe.mitre.org/data/definitions/778.html">CWE-778: Insufficient Logging</a></li>
        </ul>
    </section>

    <!-- FOOTER -->

    <footer class="badge">
        <a href="https://github.com/mikel-egana-aranguren/EHU-SGSSI-01">Fork me on GitHub</a>
    </footer>

    <div class="progress"></div>

    <script src="../ShowerTemplate/shower/shower.js"></script>
    <!-- Copyright © 3000 Yours Truly, Famous Inc. -->

</body>
</html>
